language: node_js
node_js:
  - "node"
  - "10"
  - "8"

install:
  - npm install -g codecov
  - npm install

script:
  - echo "Running tests against $(node -v) ..."
  - npm run test

jobs:
  include:
    - stage: codecov.io
      node_js: "node"
      script:
        - echo "Uploading coverage to codecov.io ..."
        - codecov
    - stage: npm release
      node_js: "node"
      script:
        - echo "Deploying to npm ..."
      deploy:
        provider: script
        script: npx semantic-release
        on:
          branch: master
